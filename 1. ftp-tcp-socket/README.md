# FTP TCP Socket νμΌ μ „μ†΅ ν”„λ΅κ·Έλ¨

TCP μ†μΌ“μ„ μ‚¬μ©ν• κ°„λ‹¨ν• νμΌ μ „μ†΅ μ‹μ¤ν…μ…λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„λ΅ νμΌμ„ μ „μ†΅ν•κ³ , μ„λ²„λ” λ°›μ€ νμΌμ„ μ €μ¥ν•©λ‹λ‹¤.

## π“‹ λ©μ°¨

- [ν”„λ΅μ νΈ κ°μ”](#ν”„λ΅μ νΈ-κ°μ”)
- [κΈ°λ¥](#κΈ°λ¥)
- [νμΌ κµ¬μ΅°](#νμΌ-κµ¬μ΅°)
- [μ‚¬μ© λ°©λ²•](#μ‚¬μ©-λ°©λ²•)
- [λ™μ‘ μ›λ¦¬](#λ™μ‘-μ›λ¦¬)
- [μ½”λ“ μ„¤λ…](#μ½”λ“-μ„¤λ…)
- [μ£Όμμ‚¬ν•­](#μ£Όμμ‚¬ν•­)

## π― ν”„λ΅μ νΈ κ°μ”

μ΄ ν”„λ΅μ νΈλ” Pythonμ `socket` λ¨λ“μ„ μ‚¬μ©ν•μ—¬ TCP/IP κΈ°λ° νμΌ μ „μ†΅ μ‹μ¤ν…μ„ κµ¬ν„ν•©λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈλ” νμΌμ„ μ½μ–΄μ„ μ„λ²„λ΅ μ „μ†΅ν•κ³ , μ„λ²„λ” λ°›μ€ λ°μ΄ν„°λ¥Ό νμΌλ΅ μ €μ¥ν•©λ‹λ‹¤.

## β¨ κΈ°λ¥

- β… TCP μ†μΌ“μ„ ν†µν• νμΌ μ „μ†΅
- β… μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈ λ™μ‹ μ—°κ²° μ§€μ›
- β… μ²­ν¬ λ‹¨μ„(1024λ°”μ΄νΈ) λ°μ΄ν„° μ „μ†΅
- β… μ‹¤μ‹κ°„ μ „μ†΅ μƒνƒ ν‘μ‹
- β… μλ™ νμΌ μ €μ¥ (`output_0.txt`, `output_1.txt`, ...)

## π“ νμΌ κµ¬μ΅°

```
1. ftp-tcp-socket/
β”β”€β”€ tcp-server.py      # μ„λ²„ ν”„λ΅κ·Έλ¨
β”β”€β”€ tcp-client.py      # ν΄λΌμ΄μ–ΈνΈ ν”„λ΅κ·Έλ¨
β”β”€β”€ file.txt           # ν…μ¤νΈμ© νμΌ (μμ‹)
β”β”€β”€ output_0.txt       # μ„λ²„κ°€ λ°›μ€ νμΌ (μλ™ μƒμ„±)
β””β”€β”€ README.md          # μ΄ νμΌ
```

## π€ μ‚¬μ© λ°©λ²•

### 1. μ„λ²„ μ‹¤ν–‰

ν„°λ―Έλ„ 1μ—μ„ μ„λ²„λ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤:

```bash
cd "1. ftp-tcp-socket"
python3 tcp-server.py
```

μ„λ²„κ°€ μ‹μ‘λλ©΄:

- μ—°κ²°ν•  ν΄λΌμ΄μ–ΈνΈ μλ¥Ό μ…λ ¥ν•μ„Έμ”
- μ: `1` (ν΄λΌμ΄μ–ΈνΈ 1κ°)

```
Server is running on 127.0.0.1:8080
Enter the total number of clients: 1
Waiting for 1 clients to connect...
```

### 2. ν΄λΌμ΄μ–ΈνΈ μ‹¤ν–‰

**μƒ ν„°λ―Έλ„**μ—μ„ ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹¤ν–‰ν•©λ‹λ‹¤:

```bash
cd "1. ftp-tcp-socket"
python3 tcp-client.py
```

ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μ—°κ²°λλ©΄:

- μ „μ†΅ν•  νμΌ μ΄λ¦„μ„ μ…λ ¥ν•μ„Έμ”
- μ: `file.txt`
- μΆ…λ£ν•λ ¤λ©΄: `exit`

```
Client is connecting to 127.0.0.1:8080
Connected to 127.0.0.1:8080
Enter the file name to send: (or 'exit' to end) file.txt
```

### 3. μ‹¤ν–‰ κ²°κ³Ό

**μ„λ²„ μ¶λ ¥ μμ‹:**

```
Client 1 connected: ('127.0.0.1', 54321)
[ν΄λΌμ΄μ–ΈνΈ 1] νμΌ μμ‹  μ‹μ‘: output_0.txt
[ν΄λΌμ΄μ–ΈνΈ 1] λ°μ΄ν„° μμ‹ : 1024 bytes
[ν΄λΌμ΄μ–ΈνΈ 1] μ—°κ²°μ΄ λ‹«ν”μµλ‹λ‹¤. μμ‹  μ™„λ£.
[ν΄λΌμ΄μ–ΈνΈ 1] νμΌ μ €μ¥ μ™„λ£: output_0.txt

λ¨λ“  ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μΆ…λ£ μ¤‘...
μ„λ²„ μΆ…λ£
```

**ν΄λΌμ΄μ–ΈνΈ μ¶λ ¥ μμ‹:**

```
[μ „μ†΅ μ‹μ‘] νμΌ: file.txt
[μ „μ†΅ μ¤‘] 1024 bytes μ „μ†΅λ¨
[μ „μ†΅ μ™„λ£] νμΌ: file.txt
Enter the file name to send: (or 'exit' to end) exit
ν΄λΌμ΄μ–ΈνΈ μΆ…λ£
```

## π”„ λ™μ‘ μ›λ¦¬

### μ „μ²΄ νλ¦„λ„

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                    β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ ν΄λΌμ΄μ–ΈνΈ β”‚                    β”‚  μ„λ²„   β”‚
β””β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”                    β””β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”
     β”‚                              β”‚
     β”‚  1. connect()                β”‚
     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€>β”‚
     β”‚                              β”‚
     β”‚  2. accept()                 β”‚
     β”‚<β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
     β”‚                              β”‚
     β”‚  3. νμΌ μ½κΈ° (1024 bytes)     β”‚
     β”‚  4. send(data)               β”‚
     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€>β”‚
     β”‚                              β”‚  5. recv(data)
     β”‚                              β”‚  6. νμΌμ— μ“°κΈ°
     β”‚                              β”‚
     β”‚  (λ°λ³µ...)                    β”‚
     β”‚                              β”‚
     β”‚  7. close()                  β”‚
     β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€>β”‚
     β”‚                              β”‚  8. recv() β†’ λΉ λ°”μ΄νΈ
     β”‚                              β”‚  9. νμΌ λ‹«κΈ°
```

### μƒμ„Έ λ™μ‘ κ³Όμ •

1. **μ„λ²„ μ‹μ‘**

   - ν¬νΈ 8080μ—μ„ λ€κΈ°
   - ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μλ§νΌ `accept()` λ€κΈ°

2. **ν΄λΌμ΄μ–ΈνΈ μ—°κ²°**

   - μ„λ²„(127.0.0.1:8080)μ— μ—°κ²°
   - μ—°κ²° μ„±κ³µ μ‹ νμΌ μ „μ†΅ μ‹μ‘

3. **νμΌ μ „μ†΅**

   - ν΄λΌμ΄μ–ΈνΈ: νμΌμ„ 1024λ°”μ΄νΈμ”© μ½μ–΄μ„ μ „μ†΅
   - μ„λ²„: λ°›μ€ λ°μ΄ν„°λ¥Ό 1024λ°”μ΄νΈμ”© νμΌμ— μ €μ¥

4. **μ „μ†΅ μ™„λ£**
   - ν΄λΌμ΄μ–ΈνΈ: `sock.close()` νΈμ¶
   - μ„λ²„: `recv()`κ°€ λΉ λ°”μ΄νΈλ¥Ό λ°›μΌλ©΄ μ—°κ²° μΆ…λ£λ΅ μΈμ‹
   - μ„λ²„: νμΌμ„ λ‹«κ³  μ €μ¥ μ™„λ£

## π’» μ½”λ“ μ„¤λ…

### μ„λ²„ (`tcp-server.py`)

#### μ£Όμ” λ‹¨κ³„:

1. **μ†μΌ“ μƒμ„± λ° λ°”μΈλ”©**

   ```python
   sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
   sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
   sock.bind((host, port))
   sock.listen(totalClients)
   ```

2. **ν΄λΌμ΄μ–ΈνΈ μ—°κ²° μλ½**

   ```python
   for i in range(totalClients):
       conn, addr = sock.accept()
       connections.append(conn)
   ```

3. **λ°μ΄ν„° μμ‹  λ° νμΌ μ €μ¥**
   ```python
   while True:
       data_bytes = conn.recv(1024)  # λ°μ΄ν„° μμ‹ 
       if not data_bytes:  # μ—°κ²° μΆ…λ£ ν™•μΈ
           break
       data = data_bytes.decode()  # λ””μ½”λ”©
       fo.write(data)  # νμΌμ— μ“°κΈ°
       fo.flush()  # μ¦‰μ‹ λ””μ¤ν¬μ— μ €μ¥
   ```

### ν΄λΌμ΄μ–ΈνΈ (`tcp-client.py`)

#### μ£Όμ” λ‹¨κ³„:

1. **μ„λ²„ μ—°κ²°**

   ```python
   sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
   sock.connect((host, port))
   ```

2. **νμΌ μ½κΈ° λ° μ „μ†΅**

   ```python
   while True:
       data = fi.read(1024)  # νμΌμ—μ„ μ½κΈ°
       if not data:  # νμΌ λ
           break
       sock.send(data.encode())  # λ„¤νΈμ›ν¬λ΅ μ „μ†΅
   ```

3. **μ—°κ²° μΆ…λ£**
   ```python
   sock.close()  # μ„λ²„μ— μΆ…λ£ μ‹ νΈ μ „μ†΅
   ```

## β οΈ μ£Όμμ‚¬ν•­

### 1. ν¬νΈ μ¶©λ

- ν¬νΈ 8080μ΄ μ΄λ―Έ μ‚¬μ© μ¤‘μ΄λ©΄ μ¤λ¥ λ°μƒ
- ν•΄κ²° λ°©λ²•:
  ```bash
  # ν¬νΈλ¥Ό μ‚¬μ©ν•λ” ν”„λ΅μ„Έμ¤ μΆ…λ£
  lsof -ti:8080 | xargs kill -9
  ```
- λλ” μ½”λ“μ—μ„ `SO_REUSEADDR` μµμ…μ΄ μ΄λ―Έ μ„¤μ •λμ–΄ μμ–΄ μ¬μ‹μ‘ μ‹ μλ™ ν•΄κ²°λ¨

### 2. νμΌ κ²½λ΅

- ν΄λΌμ΄μ–ΈνΈλ” **ν„μ¬ λ””λ ‰ν† λ¦¬**μ— μλ” νμΌλ§ μ „μ†΅ κ°€λ¥
- μ λ€ κ²½λ΅λ‚ μƒλ€ κ²½λ΅λ¥Ό μ •ν™•ν μ…λ ¥ν•΄μ•Ό ν•¨

### 3. ν…μ¤νΈ νμΌλ§ μ§€μ›

- ν„μ¬λ” ν…μ¤νΈ νμΌλ§ μ „μ†΅ κ°€λ¥ (`.decode()` μ‚¬μ©)
- λ°”μ΄λ„λ¦¬ νμΌ μ „μ†΅μ„ μ›ν•λ©΄ `'rb'`, `'wb'` λ¨λ“μ™€ λ°”μ΄λ„λ¦¬ μ „μ†΅ ν•„μ”

### 4. μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈ

- μ„λ²„λ” μ—¬λ¬ ν΄λΌμ΄μ–ΈνΈλ¥Ό μμ°¨μ μΌλ΅ μ²λ¦¬
- λ™μ‹ μ²λ¦¬λ¥Ό μ›ν•λ©΄ `threading` λλ” `asyncio` μ‚¬μ© ν•„μ”

### 5. μ—λ¬ μ²λ¦¬

- νμΌμ„ μ°Ύμ„ μ μ—†μΌλ©΄ ν΄λΌμ΄μ–ΈνΈμ—μ„ μ¤λ¥ λ©”μ‹μ§€ μ¶λ ¥
- λ„¤νΈμ›ν¬ μ¤λ¥ μ‹ ν”„λ΅κ·Έλ¨μ΄ μΆ…λ£λ  μ μμ

## π”§ κ°μ„  κ°€λ¥ν• μ‚¬ν•­

- [ ] λ°”μ΄λ„λ¦¬ νμΌ μ „μ†΅ μ§€μ›
- [ ] νμΌ ν¬κΈ° μ‚¬μ „ μ „μ†΅ (μ§„ν–‰λ¥  ν‘μ‹)
- [ ] λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ λ™μ‹ μ²λ¦¬ (λ©€ν‹°μ¤λ λ”©)
- [ ] μ—λ¬ λ³µκµ¬ λ©”μ»¤λ‹μ¦
- [ ] νμΌλ… μ „μ†΅ κΈ°λ¥
- [ ] μ „μ†΅ μ•”νΈν™”

## π“ ν•™μµ ν¬μΈνΈ

μ΄ ν”„λ΅μ νΈλ¥Ό ν†µν•΄ ν•™μµν•  μ μλ” λ‚΄μ©:

1. **TCP μ†μΌ“ ν”„λ΅κ·Έλλ°**

   - `socket.socket()` μƒμ„±
   - `bind()`, `listen()`, `accept()` (μ„λ²„)
   - `connect()` (ν΄λΌμ΄μ–ΈνΈ)
   - `send()`, `recv()` λ°μ΄ν„° μ „μ†΅

2. **λ„¤νΈμ›ν¬ ν†µμ‹ **

   - ν΄λΌμ΄μ–ΈνΈ-μ„λ²„ λ¨λΈ
   - μ—°κ²° μ§€ν–¥ ν†µμ‹  (TCP)
   - λ°”μ΄νΈ μ¤νΈλ¦Ό μ²λ¦¬

3. **νμΌ I/O**

   - νμΌ μ½κΈ°/μ“°κΈ°
   - λ²„νΌλ§κ³Ό `flush()`
   - μ²­ν¬ λ‹¨μ„ μ²λ¦¬

4. **ν”„λ΅ν† μ½ μ„¤κ³„**
   - μ—°κ²° μΆ…λ£ μ‹ νΈ μ²λ¦¬
   - λ°μ΄ν„° μΈμ½”λ”©/λ””μ½”λ”©
